/*
 * USART1_Reg.c
 *
 *1 Protocol Selected : USART1
 *2 ENABLE APB1 Clock with RCC
 *3 ENABLE AHB1 Clock with RCC
 *4 Alternative Function of PA9 as USART1 Tx
 *5 Alternative Function of PA10 as USART1 Rx
 *5
 *  Created on: Nov 23, 2022
 *      Author: Asus
 */


#include"main.h"

void Sconfig_Init()
{
	RCC->APB2ENR |= 0x10; 						//Enable APB2ENR
	RCC->AHB1ENR |= 0x1; 							//Enable GPIOA->PA9
	GPIOA->MODER &=~0x3C0000;							//clear pa9 and pa10
	GPIOA->MODER |= 0x280000; 							//Alernate Function at PA9 AND PA10
	GPIOA->AFR[1] &=~0xFF0;						//clear pa9 and pa10
	GPIOA->AFR[1] |=0x770; 						//Enable USART1 FOR pa9 and pa10
	USART1->BRR |= 0x683; 							//9600 Baud Rate
	USART1->CR1 |= 0x4; 							//Rx Mode PA10
	USART1->CR1 |=0x8;								//Tx Mode PA9
	USART1->CR1 |= 0x2000; 							//USART1 Enable
}


void USART1_Tx(unsigned char data)
{
	while(!(USART1->SR & 0X80)) {

	}
	USART1->DR |=(data & 0xff);

}

void USART1_Send(unsigned char *str)
{
	while(*str)
	{
		USART1_Tx(*str);
		str++;
	}
}


void delay(int T)
{
	while(T--)
	{
		for(int i=0;i<100000;i++);
	}
}

int main()
{
	 Sconfig_Init();
	while(1)
	{
		USART1_Send("Hello");
		delay(1000);

	}

}
